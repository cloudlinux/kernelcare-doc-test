<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kcare-nexpose | Documentation</title>
    <meta name="description" content="KernelCare documentation">
    <script src="https://js.hs-scripts.com/5408110.js"></script>
    
    <link rel="preload" href="/assets/css/0.styles.43d9a1aa.css" as="style"><link rel="preload" href="/assets/js/app.1122a68a.js" as="script"><link rel="preload" href="/assets/js/35.0a448a5b.js" as="script"><link rel="prefetch" href="/assets/js/10.8831b03c.js"><link rel="prefetch" href="/assets/js/11.2761c21e.js"><link rel="prefetch" href="/assets/js/12.14af50c3.js"><link rel="prefetch" href="/assets/js/13.a3bd3883.js"><link rel="prefetch" href="/assets/js/14.2da15d9a.js"><link rel="prefetch" href="/assets/js/15.ebc1f5f1.js"><link rel="prefetch" href="/assets/js/16.21e6e573.js"><link rel="prefetch" href="/assets/js/17.113cc10d.js"><link rel="prefetch" href="/assets/js/18.37ea1450.js"><link rel="prefetch" href="/assets/js/19.fd84a579.js"><link rel="prefetch" href="/assets/js/20.972c1132.js"><link rel="prefetch" href="/assets/js/21.d44bbe92.js"><link rel="prefetch" href="/assets/js/22.bc479cbf.js"><link rel="prefetch" href="/assets/js/23.05b7e74d.js"><link rel="prefetch" href="/assets/js/24.12331a4b.js"><link rel="prefetch" href="/assets/js/25.8ace5f13.js"><link rel="prefetch" href="/assets/js/26.ae3946ff.js"><link rel="prefetch" href="/assets/js/27.591e223e.js"><link rel="prefetch" href="/assets/js/28.72d4447c.js"><link rel="prefetch" href="/assets/js/29.7e52a09e.js"><link rel="prefetch" href="/assets/js/3.946bf916.js"><link rel="prefetch" href="/assets/js/30.1c00c483.js"><link rel="prefetch" href="/assets/js/31.ea258652.js"><link rel="prefetch" href="/assets/js/32.77f3f0cd.js"><link rel="prefetch" href="/assets/js/33.c2a28025.js"><link rel="prefetch" href="/assets/js/34.43f69458.js"><link rel="prefetch" href="/assets/js/36.a0ca0ae4.js"><link rel="prefetch" href="/assets/js/37.35895fc1.js"><link rel="prefetch" href="/assets/js/38.f7ca08a7.js"><link rel="prefetch" href="/assets/js/39.cf13de30.js"><link rel="prefetch" href="/assets/js/4.af90392a.js"><link rel="prefetch" href="/assets/js/40.1a6c4c51.js"><link rel="prefetch" href="/assets/js/41.fdd922ee.js"><link rel="prefetch" href="/assets/js/42.19b3d2ab.js"><link rel="prefetch" href="/assets/js/43.542cb502.js"><link rel="prefetch" href="/assets/js/44.d3bdd8d2.js"><link rel="prefetch" href="/assets/js/45.4c70c388.js"><link rel="prefetch" href="/assets/js/46.5d4735e8.js"><link rel="prefetch" href="/assets/js/47.ba32945c.js"><link rel="prefetch" href="/assets/js/5.a2f68b05.js"><link rel="prefetch" href="/assets/js/6.3cc27947.js"><link rel="prefetch" href="/assets/js/7.335eb4a8.js"><link rel="prefetch" href="/assets/js/8.f47b3161.js"><link rel="prefetch" href="/assets/js/9.aebcce9a.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.97bda272.js">
    <link rel="stylesheet" href="/assets/css/0.styles.43d9a1aa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name site-name--documentation can-hide">Documentation</span></a> <form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <div class="links" style="max-width:nullpx;"><a href="https://cloudlinux.com/kernelcare-free-trial5" target="_blank" class="btn">
      Try Free
    </a> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kcare-nexpose/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/jp/kcare-nexpose/" class="nav-link">日本語</a></li></ul></div></div></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kcare-nexpose/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/jp/kcare-nexpose/" class="nav-link">日本語</a></li></ul></div></div></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><div class="sidebar-heading open"><span>Content</span> <!----></div> <ul class="sidebar-group-items"><li><a href="/installation/" class="sidebar-link">Installation of KernelCare</a></li><li><a href="/settings/" class="sidebar-link">Basic Management</a></li><li><a href="/command_line/" class="sidebar-link">Command Line Tools</a></li><li><a href="/how_to's/" class="sidebar-link">How-To's</a></li><li><a href="/config_options/" class="sidebar-link">Config Options</a></li><li><a href="/disabling_some_patches/" class="sidebar-link">Disabling Some Patches</a></li><li><a href="/delayed_feed/" class="sidebar-link">Delayed Feed</a></li><li><a href="/extra_patchset/" class="sidebar-link">Extra Patchset</a></li><li><a href="/sticky_patches/" class="sidebar-link">Sticky Patches</a></li><li><a href="/nagios_plugin/" class="sidebar-link">Nagios Plugin</a></li><li><a href="/zabbix_template/" class="sidebar-link">Zabbix Template</a></li><li><a href="/upgrade/" class="sidebar-link">Upgrade</a></li><li><a href="/uninstall/" class="sidebar-link">Uninstall KernelCare</a></li><li><a href="/technology/" class="sidebar-link">Technology</a></li><li><a href="/AWS_deployment_guide/" class="sidebar-link">KernelCare on AWS – Deployment User Guide</a></li><li><a href="/reseller_partner_ui/" class="sidebar-link">Reseller Partner UI</a></li><li><a href="/kernelcare_enterprise/" class="sidebar-link">KernelCare.ePortal</a></li><li><a href="/kcare-nexpose/" class="active sidebar-link">Kcare-nexpose</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kcare-nexpose/#installation" class="sidebar-link">Installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kcare-nexpose/#from-yum-repository" class="sidebar-link">From yum repository</a></li><li class="sidebar-sub-header"><a href="/kcare-nexpose/#from-github" class="sidebar-link">From GitHub</a></li></ul></li><li class="sidebar-sub-header"><a href="/kcare-nexpose/#how-it-works" class="sidebar-link">How It Works</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kcare-nexpose/#supported-report-types" class="sidebar-link">Supported report types</a></li></ul></li><li class="sidebar-sub-header"><a href="/kcare-nexpose/#how-to-launch" class="sidebar-link">How To Launch</a></li><li class="sidebar-sub-header"><a href="/kcare-nexpose/#yaml-config-file-description" class="sidebar-link">YAML config file description</a></li></ul></li><li><a href="/kernelcare_whmcs_plugin/" class="sidebar-link">KernelCare WHMCS Plugin</a></li><li><a href="/proxy_settings/" class="sidebar-link">Firewall and Proxy Settings</a></li><li><a href="/eol_ubuntu_lts_kernels_support/" class="sidebar-link">EOL Ubuntu LTS kernels support</a></li></ul></div></li></ul> </div> <div class="page"> <div class="breadcrumb-wrapper page-breadcrumb" data-v-5e0e0acf><span class="breadcrumb-title" data-v-5e0e0acf>Documentation:</span> <a href="/kcare-nexpose/" class="breadcrumb router-link-exact-active router-link-active" data-v-5e0e0acf>
    Kcare-nexpose
  </a></div> <div class="page-nav-wrapper"><div class="page-nav"><a href="/kernelcare_enterprise/" class="link prev">
      ←
    </a> <a href="/kernelcare_whmcs_plugin/" class="link">
      →
    </a></div></div> <div class="content"><h1 id="kcare-nexpose"><a href="#kcare-nexpose" aria-hidden="true" class="header-anchor">#</a> Kcare-nexpose</h1> <p>The script marks vulnerabilities detected by Nexpose, but patched by KernelCare as exceptions.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>If you are new in Nexpose, please read the <a href="https://nexpose.help.rapid7.com/docs/" target="_blank" rel="noopener noreferrer">official documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> on how to set up and operate.</p></div> <h2 id="installation"><a href="#installation" aria-hidden="true" class="header-anchor">#</a> Installation</h2> <h3 id="from-yum-repository"><a href="#from-yum-repository" aria-hidden="true" class="header-anchor">#</a> From yum repository</h3> <p>To install kcare-nexpose, start with the minimal image of EL6:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cat &gt; /etc/yum.repos.d/kcare-eportal.repo &lt;&lt;EOL
[kcare-eportal]
name=kcare-eportal
baseurl=http://repo.eportal.kernelcare.com/x86_64/
gpgkey=http://repo.cloudlinux.com/kernelcare-debian/6/conf/kcaredsa_pub.gpg
enabled=1
gpgcheck=1
EOL
</code></pre></div><p>To install kcare-nexpose, run the command:</p> <div class="language- extra-class"><pre class="language-text"><code>$ yum install kcare-nexpose
</code></pre></div><p></p> <h3 id="from-github"><a href="#from-github" aria-hidden="true" class="header-anchor">#</a> From GitHub</h3> <p></p> <div class="language- extra-class"><pre class="language-text"><code>$ git clone https://github.com/cloudlinux/kcare-nexpose.git
$ cd kcare-nexpose/
$ python setup.py install
$ pip install -r REQUIREMENTS
</code></pre></div><h2 id="how-it-works"><a href="#how-it-works" aria-hidden="true" class="header-anchor">#</a> How It Works</h2> <p>The script finds CVEs that are related to patches applied by KernelCare (downloaded either from KernelCare ePortal or the central KernelCare patch server) and excludes them from Nexpose vulnerability scanner reports. The script can approve this exception in Nexpose (if you do not want to approve, set <code>is_approve</code> to <code>false</code> in the script config). It can also remove the old exceptions left from the previous script runs (set <code>delete_old</code> to <code>true</code> in the script config).</p> <p>First, you should generate report in Nexpose (see supported report types below) and specify it in the config file. Also you need to specify some other <a href="/kcare-nexpose/#yaml-config-file-description">parameters</a>:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cp /usr/local/etc/kcare-nexpose.yml.template /usr/local/etc/kcare-nexpose.yml
$ vim /usr/local/etc/kcare-nexpose.yml
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">Note</p> <p>IP address in Nexpose and the one in KernelCare ePortal should be the same. If you use Nexpose and KernelCare ePortal on different instances, you should make sure that Nexpose and KernelCare ePortal are not using localhost (127.0.0.1). Otherwise, kcare-nexpose can mark vulnerability wrong, as it just analyzes IP addresses from Nexpose and KernelCare ePortal. If used with CLN license server, the script can work with servers behind NAT by matching them by their hostnames.</p></div> <p></p> <h3 id="supported-report-types"><a href="#supported-report-types" aria-hidden="true" class="header-anchor">#</a> Supported report types</h3> <div class="warning custom-block"><p class="custom-block-title">Note</p> <p>Please make sure that you have configured a <a href="https://nexpose.help.rapid7.com/docs/what-is-a-site" target="_blank" rel="noopener noreferrer">site<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and a <a href="https://nexpose.help.rapid7.com/docs/selecting-a-scan-engine-for-a-site" target="_blank" rel="noopener noreferrer">scan<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> before creating a report.</p></div> <p><em>raw-xml-v2</em></p> <p><img src="/images/nexpose-xml2_zoom70.png" alt></p> <h2 id="how-to-launch"><a href="#how-to-launch" aria-hidden="true" class="header-anchor">#</a> How To Launch</h2> <p>To launch kcare-nexpose run:</p> <div class="language- extra-class"><pre class="language-text"><code>$ kcare-nexpose -c /usr/local/etc/kcare-nexpose.yml
</code></pre></div><h2 id="yaml-config-file-description"><a href="#yaml-config-file-description" aria-hidden="true" class="header-anchor">#</a> YAML config file description</h2> <div class="language- extra-class"><pre class="language-text"><code># Nexpose section
nexpose:
 
# Host to connect with Nexpose Security Console
 host: 192.168.100.100
 
 # Port to connect with Nexpose Security Console
 port: 3780
 
 # Username to auth with Nexpose Security Console
 username: admin
 
 # Password to auth with Nexpose Security Console
 password: hup^r37kZc72MjY}=ox?WTQ
 
 # Report name which will be analyzed for look up related CVE with kernelcare ePortal
 report-name: kernelcare
 
 # Change this to 'true' if you want the script to automatically mark
 # vulnerabilities as exceptions, so they don't show up in the report
 is_approve: true
 
 # If you want to delete old exceptions. If it is false, old exceptions will not be deleted
 delete_old: true
 
 format: raw-xml-v2
 
# License and patch server section
patch-server:
 
 # URL to connect to Kernelcare ePortal
 # For kernelcare ePortal use &quot;http://&lt;kernel-care-eportal-domain-name-or-ip&gt;/admin/api/kcare/patchset/&quot;
 # For licenses issued by CLN, use &quot;https://cln.cloudlinux.com/api/kcare/patchset.json?key=&quot;
 server: https://cln.cloudlinux.com/api/kcare/patchset.json?key=
 
 # Server for patch sets
 # For patch sets from Kernelcare ePortal server use domain name
 # (or IP address)
 # patches-info: http://&lt;kernel-care-eportal-domain-name-or-ip&gt;
 
 # For patch sets from the central KernelCare patch server
 patches-info: http://patches.kernelcare.com/
 
 # List of KernelCare license keys
 keys:
   - 0G0996952sTtCU4z
   - hx5LO1n49zY5jp6B
</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/kernelcare-doc/edit/dev/docs/kcare-nexpose/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> </div> <div class="footer" data-v-20b89de8><div data-v-20b89de8><a href="https://cloudlinux.com" data-v-20b89de8><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-20b89de8></a></div> <div class="footer-company-title" data-v-20b89de8>2023. CloudLinux Inc</div> <div data-v-20b89de8><div data-v-20b89de8><a href="https://www.kernelcare.com/install-kernelcare/" target="_blank" data-v-20b89de8>How to</a></div><div data-v-20b89de8><a href="https://www.kernelcare.com/faq/" target="_blank" data-v-20b89de8>Sales and Technical FAQs</a></div><div data-v-20b89de8><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-20b89de8>Contact support</a></div><div data-v-20b89de8><a href="https://www.kernelcare.com/blog/" target="_blank" data-v-20b89de8>Blog</a></div></div> <div class="social" data-v-20b89de8><span class="footer-social-text" data-v-20b89de8>Stay in touch</span> <a href="https://www.facebook.com/kernelcare/" target="_blank" data-v-20b89de8><img src="/fb.png" class="footer-social-logo" data-v-20b89de8></a><a href="https://twitter.com/kernelcare/" target="_blank" data-v-20b89de8><img src="/tw.png" class="footer-social-logo" data-v-20b89de8></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-20b89de8><img src="/in.png" class="footer-social-logo" data-v-20b89de8></a><a href="https://www.youtube.com/channel/UCZ3YMHWnMP7TaxlXVay5-aw" target="_blank" data-v-20b89de8><img src="/ytube.png" class="footer-social-logo" data-v-20b89de8></a></div></div> <!----></div></div>
    <script src="/assets/js/app.1122a68a.js" defer></script><script src="/assets/js/35.0a448a5b.js" defer></script>
  </body>
</html>
